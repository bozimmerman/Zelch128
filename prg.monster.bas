!--------------------------------------------------
!- Tuesday, May 16, 2017 10:29:47 PM
!- Import of : 
!- c:\src\zelch128next\prg.monster.prg
!- Unknown Machine
!--------------------------------------------------
30000 SYS15625:REM =========== AUTO-MAINTENANCE W/SCRIPT =========== 06/29/91 =
30010 IFPEEK(2961)<2THENPOKE2829,1:POKE2823,1:POKE2961,2:GOSUB18:PRINT"{clear}{down}{ct n}{cyan}Monster Mode v2.0--Loading script...";:X=-1:ELSE30210
30020 POKE2825,255:POKE2824,1:POKE2827,0:O$="Monster Mode v2.0":GOSUB250:P0=1
30030 OPEN1,D(1,0),15:OPEN2,D(1,0),2,MID$(STR$(D(1,1)),2)+":sys.script,s,r":INPUT#1,A:IFATHENPRINT"{left*17}Default script.  ":CLOSE1:CLOSE2:GOTO30050
30040 X=X+1:SYS8222:TT$(X)=I$:IFPEEK(253)=0THEN30040:ELSETT$(X+1)="{pound}":CLOSE2:CLOSE1:PRINT:GOTO30110
30050 TT$(0)="user 60":TT$(1)="msg":TT$(2)="news":TT$(3)="collect":TT$(4)="{pound}":X=3:GOTO30110
30060 OPEN2,D(1,0),2,MID$(STR$(D(1,1)),2)+":sys.network":RETURN
30100 REM ----------- CHANGE COMMANDS TO LOWERCASE ----------------------------
30110 FORI=0TOX:IFTT$(I)=" "ORTT$(I)=""ORLEFT$(TT$(I),1)=";"THENTT$(I)="^"
30120 NEXTI:FORI=0TOX:A=0:FORY=1TOLEN(TT$(I)):A$=MID$(TT$(I),Y,1)
30130 IFA$="{f5}"THENA=ABS(A-1):GOTO30160
30140 IFATHEN30160
30150 MID$(TT$(I),Y,1)=CHR$(ASC(A$)AND127)
30160 NEXTY:NEXTI
30200 REM ----------- EXECUTE NEXT SCRIPT COMMAND -----------------------------
30210 CLOSE1:CLOSE15:CLOSE2:CLOSE3:CLOSE4:X=-1
30215 X=X+1:IFX>100THEN50010
30220 A$=TT$(X):IFA$="{pound}"THEN50010:ELSEIFA$="^"THEN30215
30230 TT$(X)="^":IFINSTR(A$,"{f5}")=0THENF$="":GOTO30250
30240 F$=MID$(A$,INSTR(A$,"{f5}")+1)+"{f5}":F$=LEFT$(F$,INSTR(F$,"{f5}")-1)
30250 A=INSTR(A$,","):IFA=0THENU=D(0,0):D=D(0,1):GOTO30270
30260 U=VAL(MID$(A$,A-2)):D=VAL(MID$(A$,A+1))
30270 A=INSTR(A$,"{f5}"):IFA<1THENA=INSTR(A$,","):IFA<1THENI$=A$:GOTO30300
30280 I$=LEFT$(A$,A-1)
30300 IFINSTR(I$,"user")THEN30610
30310 IFINSTR(I$,"msg")ORINSTR(I$,"message")THEN31010
30320 IFINSTR(I$,"news")THEN30810
30330 IFINSTR(I$,"collect")ORINSTR(I$,"validate")THEN31210
30340 IFINSTR(I$,"print")THENO$=F$:GOSUB4:GOTO30210
30350 IFINSTR(I$,"run")THENI$=F$:O$="Online Basic":GOSUB250:POKE2961,2:GOTO8940
30360 IFINSTR(I$,"execute")THENO$="Zelch Specific Module":GOSUB250:I$=F$:GOTO23
30370 IFINSTR(I$,"dos")ORINSTR(I$,"disk")THEN31310
30380 IFINSTR(I$,"display")ORINSTR(I$,"file")THENGOSUB26:GOTO30210
30390 IFINSTR(I$,"hard")THEN31410
30400 IFINSTR(I$,"clear")ORINSTR(I$,"reset")THEN31510
30410 IFINSTR(I$,"modem")ORINSTR(I$,"hayes")THENA$=F$:GOSUB2:GOTO30210
30420 IFINSTR(I$,"network")THENW1=.2:I$="prg.network":U=D(0,0):D=D(0,1):GOTO23
30590 GOTO30210
30600 REM ----------- USER WEED ROUTINES --------------------------------------
30610 IFINSTR(A$," ")=0THENA$=A$+" 60"
30620 A$=MID$(A$,INSTR(A$," ")+1):X=VAL(A$):IFX<1THEN30610
30630 GOSUB400:OPEN1,D(5,0),15:OPEN2,D(4,0),2,MID$(STR$(D(4,1)),2)+":sys.userfiles":W1=1:W5=0
30640 W2=VAL(MID$(O$(2),5,2)):W3=VAL(MID$(O$(2),3,2)):W4=VAL(LEFT$(O$(2),2)):FORI=1TOX
30650 W2=W2-1:IFW2<1THENW3=W3-1:W2=PEEK(2880+W3):IFW3<1THENW3=12:W2=31:W4=W4-1:IFW4<0THENW4=99
30660 NEXTI:W1$=RIGHT$(STR$(W4),2)+RIGHT$(STR$(W3),2)+RIGHT$(STR$(W2),2):DO:W7=INSTR(W1$," "):IFW7>0THENMID$(W1$,W7,1)="0"
30670 LOOPUNTILW7=0
30680 O$="Checking userfiles...":GOSUB250:I=FRE(1)
30690 IFUI$(W1)="^"THENW1=W1+1:IFW1<501THEN30690
30700 IFUI$(W1)=""ORUI$(W1)="{pound}"ORW1>500THENCLOSE2:CLOSE1:GOTO30210
30710 RECORD#2,W1:FORI=1TO6:SYS8222:NEXTI:A$=I$:FORI=1TO2:SYS8222:NEXTI:IFLEFT$(A$,6)>W1$ORMID$(I$,3,1)="1"THENW1=W1+1:GOTO30690
30720 O$="Munching user":GOSUB250:A$="^"+R$+"{f4}"+R$+"^"+R$+"(xxx)/xxx-xxxx"+R$+"A"+R$+"^"+R$+"00/00/00"+R$+"00000000000"+R$
30725 FORI=1TO2:A$=A$+"00000000000000000000000000"+R$:NEXTI:FORI=1TO8:A$=A$+" 0"+R$:NEXTI:RECORD#2,W1:PRINT#2,A$:A$="":I=FRE(1)
30730 PRINT#1,"s"+MID$(STR$(D(5,1)),2)+":mail."+STR$(W1):P0$(P0)="Munched user #"+STR$(W1)+"/"+UI$(W1):UI$(W1)="^":P0=P0+1:W1=W1+1:GOTO30680
30800 REM ----------- NEWS FILE ROUTINES --------------------------------------
30810 IFF$=""THENF$="sys.news":U=D(1,0):D=D(1,1)
30820 O$="Updating "+F$:GOSUB250:X=0:GOSUB400:OPEN1,U,15:OPEN2,U,2,MID$(STR$(D),2)+":"+F$+",s,r":INPUT#1,E:IFE>0THEN30910
30830 SYS8222:SYS8222:IFPEEK(253)THEN30210
30840 IFI$>=O$(2)THENSYS8213:GOTO30830
30850 CLOSE2:CLOSE1:OPEN1,U,15,"s"+MID$(STR$(D),2)+":sys.work":OPEN2,U,2,MID$(STR$(D),2)+":"+F$+",s,r":X=0
30860 OPEN3,U,3,MID$(STR$(D),2)+":sys.work,s,w"
30870 SYS8222:A$=I$:SYS8222:IFPEEK(253)THEN30910
30880 IFO$(2)>I$THENSYS8222:SYS8213:P0$(P0)="Stomped "+F$+" #"+STR$(X+1)+"/{f5}"+I$+"{f5}":P0=P0+1:GOTO30870
30890 IFX>0THENPRINT#3,CHR$(1)
30900 PRINT#3,A$:PRINT#3,I$:GOSUB31:X=X+1:GOTO30870
30910 CLOSE2:CLOSE3:IFX=0THENPRINT#1,"s"+MID$(STR$(D),2)+":sys.work":PRINT#1,"s"+MID$(STR$(D),2)+":"+F$:GOTO30210
30920 PRINT#1,"s"+MID$(STR$(D),2)+":"+F$:PRINT#1,"r"+MID$(STR$(D),2)+":"+F$+"=sys.work":GOTO30210
31000 REM ----------- WEED MESSAGE BASES --------------------------------------
31010 W1=1:W9=26:IFINSTR(A$,",")>0ANDD>=UANDU>=1ANDD<=26THENW1=U:W9=D
31020 CLOSE2:CLOSE1:OPEN1,D(1,0),15:OPEN2,D(1,0),2,MID$(STR$(D(1,1)),2)+":sys.mbases"+F$:INPUT#1,E:IFE>0THEN30210
31025 IFW1>W9THEN30210:ELSERECORD#2,W1:SYS8222:U=VAL(I$):IFU<8THENW1=W1+1:GOTO31025
31030 INPUT#2,D:FORI=1TO5:SYS8222:TT$(150+I)=I$:NEXTI:I=FRE(1)
31040 C$=F$+CHR$(192+W1):O$="Sniffing sig /"+C$:GOSUB250
31050 IFVAL(TT$(155))=0ORLEFT$(TT$(154),1)<>"{sh @}"THENW1=W1+1:GOTO31025
31060 CLOSE2:CLOSE1:OPEN2,D(1,0),2,MID$(STR$(D(1,1)),2)+":sys.mdata"+F$
31065 RECORD#2,((W1-1)*51)+51:INPUT#2,W2:FORI=1TOW2:RECORD#2,((W1-1)*51)+I:SYS8222:MN$(I)=I$:INPUT#2,MR(I)
31070 NEXTI:CLOSE2:FORI=1TOW2:IFMR(I)=0ORVAL(MN$(I))=0ORMR(I)<VAL(TT$(152))THEN31160
31080 O$="Chewing msg /"+C$+" #"+STR$(I):GOSUB250:CLOSE1:CLOSE2:CLOSE3:OPEN1,U,15,"s"+MID$(STR$(D),2)+":sys.work"
31090 OPEN2,U,2,MID$(STR$(D),2)+":msg."+C$+STR$(I)+",s,r"
31100 OPEN3,U,3,MID$(STR$(D),2)+":sys.work,s,w":P0$(P0)="Chewed message /"+C$+" #"+STR$(I):P0=P0+1
31110 SYS8222:IFI$<>CHR$(1)THENPRINT#3,I$:GOTO31110
31120 PRINT#3,I$:FORX=1TOMR(I)-VAL(TT$(153)):SYS8213:MR(I)=MR(I)-1:NEXTX
31130 SYS8222:IFPEEK(253)=0THENPRINT#3,I$:GOTO31130
31140 PRINT#3,I$:CLOSE3:CLOSE2:PRINT#1,"s"+MID$(STR$(D),2)+":msg."+C$+STR$(I):PRINT#1,"r"+MID$(STR$(D),2)+":msg."+C$+STR$(I)+"=sys.work"
31150 CLOSE1:OPEN2,D(1,0),2,MID$(STR$(D(1,1)),2)+":sys.mdata"+F$:RECORD#2,((W1-1)*51)+I:PRINT#2,MN$(I)+CHR$(13)+STR$(MR(I)):CLOSE2:O$="Burp!":GOSUB250
31160 NEXTI:W1=W1+1:GOTO31020
31200 REM ----------- COLLECT/VALIDATE ----------------------------------------
31210 O$="Eating Disk"+STR$(U)+","+MID$(STR$(D),2):GOSUB250
31220 OPEN1,U,15,"v"+MID$(STR$(D),2):GOTO30210
31300 REM ----------- DOS COMMANDS --------------------------------------------
31310 O$="Drooling on drive"+STR$(U)+","+MID$(STR$(D),2):GOSUB250
31320 OPEN1,U,15,F$:INPUT#1,I:CLOSE1:GOTO30210
31400 REM ----------- HARDCOPY A SEQ FILE TO PRINTER DEVICE 4 -----------------
31410 O$="Scratching on paper":GOSUB250
31420 OPEN1,U,15:OPEN2,U,2,MID$(STR$(D),2)+":"+F$+",s,r":INPUT#1,E:IFETHENCLOSE1:CLOSE2:GOTO30210:ELSEOPEN4,4,7
31430 SYS8222:FORX=1TO4:DO:A$=MID$("{ct k}{f6}{f5}{f7}",X,1):A=INSTR(I$,A$):IFATHENMID$(I$,A,1)=MID$(CHR$(13)+CHR$(13)+CHR$(34)+" ",X,1)
31440 LOOPUNTILA=0:NEXTX:PRINT#4,I$:IFPEEK(253)THENCLOSE1:CLOSE2:CLOSE4:GOTO30210:ELSE31430
31500 REM ----------- CLEAR OR RESET SYSTEM VARIABLE --------------------------
31510 A=INSTR(A$," "):IFA=0THEN30210
31520 A$=MID$(A$,A+1):IFVAL(A$)<1THEN31510
31530 O(VAL(A$))=0:GOTO30210
50000 REM ----------- MONSTER MODE REPORT -------------------------------------
50010 U=D(1,0):D=D(1,1):OPEN1,U,15:OPEN2,U,2,MID$(STR$(D),2)+":sys.userlog,s,a":INPUT#1,E:IFE>0THENCLOSE2:OPEN2,U,2,MID$(STR$(D),2)+":sys.userlog,s,w"
50020 PRINT#2,"{reverse on}{light green}MONSTER{sh space}MODE{sh space}REPORT{reverse off}: ";:IFP0=1THENPRINT#2,"Growl!{ct k}":CLOSE2:CLOSE1:GOTO50040
50030 PRINT#2:FORI=1TOP0-1:PRINT#2,P0$(I):P0$(I)="":NEXTI:PRINT#2,"":CLOSE2:CLOSE1
50040 FORI=1TO50:MN$(I)="":MR(I)=0:NEXTI:FORI=0TO200:TT$(I)="":NEXTI:POKE2961,0
50099 CLOSE2:CLOSE1:I=FRE(1):I$="prg.logon":U=D(0,0):D=D(0,1):GOTO23
55555 U=PEEK(186):OPEN1,U,15,"s0:prg.monster":CLOSE1:DSAVE"prg.monster",U(U)
