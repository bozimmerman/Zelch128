!--------------------------------------------------
!- Monday, May 15, 2017 12:17:26 AM
!- Import of : 
!- c:\src\zelch128\prg.new user.prg
!- Commodore 128 BASIC 7/7.1
!--------------------------------------------------
30000 SYS15625:REM ============= NEW USER MODULE V1.0 ============= 09/22/90 =
30010 IFO(1)=1THENO(1)=0:GOTO32800:ELSEO$="New User Login":GOSUB250:F$="sys.new msg":U=D(1,0):D=D(1,1):GOSUB25:POKE2825,8:POKE2824,1:X=M(14)+1
30100 U$(8)=RIGHT$(STR$(M(1)),1)+"0"+RIGHT$(STR$(M(12)),1)
30200 DO:X=X-1:LOOPUNTILUI$(X)=""ORUI$(X)="^"ORX=1:IFX=1THENO$=T$(43):GOSUB4:GOTO600
30300 GOSUB30400:GOSUB30700:GOSUB30900:GOSUB31100:GOSUB31300:GOTO31500
30400 O$=T$(44):GOSUB4:X=16:GOSUB5:IFLEN(I$)<2ORI$="NEW"THEN30400:ELSEU$(1)=I$
30500 O$=T$(45):GOSUB4:I=1:DOUNTILI$=UI$(I)ORUI$(I)="":I=I+1:LOOP:IFUI$(I)=I$THENO$=T$(46):GOSUB4:GOTO30400
30600 O$=R$:GOSUB9:RETURN
30700 O$=T$(47):GOSUB4:X=16:GOSUB5:IFI$=""THEN30500:ELSEU$(3)=I$
30800 RETURN
30900 O$=T$(48):GOSUB4:X=10:GOSUB5:IFLEN(I$)<>10THEN30900
31000 U$(4)="("+LEFT$(I$,3)+")/"+MID$(I$,4,3)+"-"+RIGHT$(I$,4):RETURN
31100 O$=T$(49):GOSUB4:X=8:GOSUB5:IFI$=""THEN31100
31200 U$(2)=I$:RETURN
31300 O$=T$(50):GOSUB4:C$="YN":GOSUB28:IFI=2THENI=0
31400 O$=A$:GOSUB4:MID$(U$(8),2,1)=RIGHT$(STR$(I),1):POKE2915,I:RETURN
31500 U$(5)="A":GOSUB400:U$(6)=O$(2):U$(7)="00000000000000000000000000":U$(9)=" 1":U(1)=M(10):U(2)=M(11):U(3)=BA
31600 O$="{clear}{ct k}{black}1) Handle      : {white}"+U$(1)+"{ct k}{black}2) Real name   : {white}"+U$(3)+"{ct k}{black}3) Phone number:{white} "+U$(4):GOSUB4
31700 O$="{black}4) Password    : {white}"+U$(2)+"{ct k}{black}5) Columns     :{white}"+STR$(40+(40*VAL(MID$(U$(8),2,1)))):GOSUB4:O$="{ct k}{white}Edit which item{f7}(return = continue): {ct c}":GOSUB4
31800 C$="12345"+R$:GOSUB28:O$=A$:GOSUB4:IFI=6THEN31900:ELSEONIGOSUB30400,30700,30900,31100,31300:GOTO31600
31900 O$=T$(51):GOSUB4:I=1:DO:I=I+1:LOOPUNTILUI$(I)="^"ORUI$(I)=""
32000 ID=I:UI$(I)=U$(1):O(6)=O(6)+1:O$=T$(52):GOSUB4:C$=R$:GOSUB28:O$=A$:GOSUB4:FORI=0TO50:TT$(I)="":NEXTI
32100 OPEN1,D(1,0),15:OPEN2,D(1,0),2,STR$(D(1,1))+":sys.new app,s,r":INPUT#1,I:IFI>19THENCLOSE2:CLOSE1:GOTO2000:ELSEW2=0:W1=0
32200 W2=W2+1:SYS8222:W1=PEEK(253):O$=I$+" {ct c}":GOSUB4:X=40:GOSUB5:IFI$=""THENI$="(no answer)"
32300 Y=INSTR(O$,"{ct c}"):IFYTHENMID$(O$,Y,1)="{reverse off}"
32400 TT$(W2)=O$+I$:IFW1=0THEN32200
32500 CLOSE2:CLOSE1:O$=T$(53):GOSUB4:C$="YN":GOSUB28:O$=A$:GOSUB4:IFI=2THEN32100:ELSEO$=T$(54):GOSUB4
32600 OPEN1,D(1,0),15:OPEN2,D(1,0),2,STR$(D(1,1))+":sys.new user,s,a":INPUT#1,I:IFI>19THENCLOSE2:OPEN2,D(1,0),2,STR$(D(1,1))+":sys.new user,s,w"
32700 PRINT#2,CHR$(13):PRINT#2,"{reverse on}{white}"+U$(1)+" (#"+STR$(ID)+")":FORI=1TOW2:PRINT#2,TT$(I):NEXTI:CLOSE2:CLOSE1:GOTO2000
32800 O$="{ct k}{black}1) Handle   : {white}"+U$(1)+"{ct k}{black}2) Password : {white}"+U$(2)+"{ct k}{black}3) Columns  :{white}"+STR$(40+(40*VAL(MID$(U$(8),2,1))))+"{ct k}{black}4) Last call: {white}"+O$(4):GOSUB4
32900 O$="{ct k}{black}Edit which item{f7}(return = continue): {ct c}":GOSUB4:C$="1234"+R$:GOSUB28:O$=A$:GOSUB4:ONIGOSUB30400,31100,31300,33100:UI$(ID)=U$(1)
33000 IFI=5THENGOSUB100:GOTO940:ELSE32800
33100 O$=T$(55):GOSUB4:GOSUB10:A=SGN(I):IFI=0THENRETURN
33200 W1=VAL(LEFT$(U$(6),2)):W2=VAL(MID$(U$(6),3,2)):W3=VAL(MID$(U$(6),5,2)):FORX=1TOABS(I):W3=W3+(A):IFW3>PEEK(2880+W2)THENW2=W2+1:W3=1
33300 IFW3<1THENW2=W2-1:W3=PEEK(2880+W2)
33400 IFW2>12THENW2=1:W1=W1+1:W3=1:ELSEIFW2<1THENW2=12:W1=W1-1:W3=31
33500 IFW1>99THENW1=0:ELSEIFW1<0THENW1=99
33600 NEXTX:U$(6)=RIGHT$(STR$(W1),2)+RIGHT$(STR$(W2),2)+RIGHT$(STR$(W3),2)+RIGHT$(U$(6),4)
33700 X=INSTR(U$(6)," "):IFX>0THENMID$(U$(6),X,1)="0":GOTO33700
33800 GOSUB400:RETURN
55555 OPEN1,8,15,"s0:prg.new user":CLOSE1:SAVE"prg.new user",8
