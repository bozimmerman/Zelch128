!--------------------------------------------------
!- Tuesday, August 17, 2021 11:57:07 PM
!- Import of : 
!- c:\tmp\newproject\bnk.maint.prg
!- Unknown Machine
!--------------------------------------------------
30000 SYS15625:REM*************** BANKING MAINT 1.0 ************************
30010 REM ******************************************************************
30020 REM ****** MAKE SURE THIS MODULE RUNS ONCE PER DAY DURING YOUR *******
30030 REM ********************** SYSTEMS MONSTER MODE **********************
30040 REM ******************************************************************
30050 U=9:O$="Bank Maint...":GOSUB250:U1=U:D1=D:FORI=1TO50:VT(I)=0:VT$(I)="":NEXT:W9$="":FORI=0TO14:W9$=W9$+" 0"+R$:NEXTI
30060 OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.records"
30070 RECORD#2,1:FORI=1TO7:SYS8222:VT(40+I)=VAL(I$):NEXTI:CLOSE2:W1=1:GOTO30999
30500 A$="":FORI=1TO6:SYS8222:A$=A$+I$+R$:NEXT
30510 FORI=1TO4:GET#2,I$:A$=A$+CHR$(ASC(I$+CHR$(0))):NEXT
30520 FORI=8TO9:SYS8222:A$=A$+I$+R$:NEXT
30530 FORI=1TO4:GET#2,I$:A$=A$+CHR$(ASC(I$+CHR$(0))):NEXT
30540 SYS8222:A$=A$+I$+R$
30550 SYS8222:I=VAL(I$):A$=A$+STR$(I+Y)+R$:Y=I
30560 FORI=3TO6:SYS8222:A$=A$+I$+R$:NEXT:RETURN
30999 OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.accounts"
31000 IFUI$(W1)=""THENCLOSE2:I$="prg.monster":U=D(0,0):D=D(0,1):GOTO23
31010 IFUI$(W1)="^"THENRECORD#2,W1:RECORD#2,W1:PRINT#2,W9$:W1=W1+1:GOTO31000
31020 RECORD#2,W1:FORI=0TO14:SYS8222:VT$(I)=I$:VT(I)=VAL(I$):NEXTI:W0=0
31030 IFVT(1)>0THENVT(1)=(VT(1)*(VT(41)/3000))+VT(1):VT$(1)=STR$(VT(1)):W0=W0OR1
31040 IFVT(2)>0THENVT(2)=(VT(2)*(VT(42)/3000))+VT(2):VT$(2)=STR$(VT(2)):W0=W0OR1
31050 IFVT(3)THENVT$(3)="0":VT(3)=0:W0=W0OR1
32000 IFVT(4)=0ORVT(6)=0THEN33000:REM******APPROPRIATIONS
32010 W9=VAL(MID$(VT$(5),3)):W9=W9-1:IFW9<1THENW9=VT(7)
32020 VT$(5)=LEFT$(VT$(5),1)+";"+STR$(W9):IFW9<>VT(7)THEN33000
32030 C$=VT$(4)
32040 W2=VAL(C$):IFW2=0THEN32100:ELSEY=INSTR(C$,";"):IFY=0THENC$="":ELSEC$=MID$(C$,Y+1)
32050 CLOSE2:OPEN2,D(4,0),2,MID$(STR$(D(4,1)),2)+":sys.userfiles":W0=W0OR2
32060 IFVT(5)=0THENRECORD#2,W1:Y=-VT(6):GOSUB30500:IFY>=VT(6)THENRECORD#2,W1:RECORD#2,W1:PRINT#2,A$:ELSEIFVT(5)=0THENVT$(4)="0":VT(4)=0:GOTO32200
32070 IFVT(5)=1ANDVT(1)>=VT(6)THENVT(1)=VT(1)-VT(6):VT$(1)=STR$(VT(1)):ELSEIFVT(5)=1THENVT$(4)="0":VT(4)=0:GOTO32200
32080 IFVT(5)=2ANDVT(2)>=VT(6)THENVT(2)=VT(2)-VT(6):VT$(2)=STR$(VT(2)):ELSEIFVT(5)=2THENVT$(4)="0":VT(4)=0:GOTO32200
32090 RECORD#2,W2:Y=VT(6):GOSUB30500:RECORD#2,W2:PRINT#2,A$
32100 IFVAL(C$)THEN32040
32200 CLOSE2
33000 IFVT(8)=0THEN34000:ELSE33020:REM*****LOANS
33010 VT$(9)="0":X=VAL(MID$(VT$(10),3)):X=X+VT(9):VT$(10)=LEFT$(VT$(10),1)+";"+STR$(X):VT(9)=0:RETURN
33020 W0=W0OR1:GOSUB400:W2=VAL(MID$(O$(2),5,2))
33030 IFVT(10)=1THENIFW2=1THENVT(9)=VT(9)+(VT(8)*(.17+(VT(47)/580)))
33040 IFVT(10)=2THENIFW2=1ORW2=15THENVT(9)=VT(9)+(VT(8)*(.09+(VT(47)/1100)))
33050 IFVT(10)=3THENIFW2=1ORW2=8ORW2=17ORW2=24THENVT(9)=VT(9)+(VT(8)*(.05+(VT(47)/2000)))
33060 IFVT(10)=4THENVT(9)=VT(9)+(VT(8)*(.01+(VT(47)/10000)))
33070 VT$(9)=STR$(VT(9))
33080 IFVT(9)>0ANDVT(1)>=VT(9)THENVT(1)=VT(1)-VT(9):VT$(1)=STR$(VT(1)):GOSUB33010
33090 IFVT(9)>0ANDVT(10)=4ANDVT(2)>=VT(9)THENVT(2)=VT(2)-VT(9):VT$(2)=STR$(VT(2)):GOSUB33010
33100 IFVT(9)=0THEN33130:ELSEW0=W0OR2:CLOSE2:OPEN2,D(4,0),2,MID$(STR$(D(4,1)),2)+":sys.userfiles":RECORD#2,W1:Y=-INT(VT(9)):GOSUB30500
33110 IFY>=INT(VT(9))THENRECORD#2,W1:PRINT#2,A$:GOSUB33010
33120 CLOSE2
33130 IFVT(9)>0ANDVT(2)>=VT(9)THENVT(2)=VT(2)-VT(9):VT$(2)=STR$(VT(2)):GOSUB33010
33140 IFVT(9)>0THENVT(11)=VT(11)+1:VT$(11)=STR$(VT(11)):IFVT(11)<=14THEN33200:ELSEIFVT(9)=0THEN33200
33150 W0=W0OR2:CLOSE2:OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.records":Y=1:DO:Y=Y+1:RECORD#2,Y:SYS8222:LOOPUNTILI$="^"ORI$="{pound}":RECORD#2,Y
33160 PRINT#2,STR$(W1)+R$+STR$(-INT(VT(8)-VAL(MID$(STR$(VT(10)),3)))):CLOSE2:VT$(8)="0":VT(8)=0:OPEN2,D(4,0),2,MID$(STR$(D(4,1)),2)+":sys.userfiles"
33170 RECORD#2,W1:SYS8222:SYS8222:SYS8222:CLOSE2:OPEN1,U1,15:OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.blacklist,s,w":INPUT#1,E
33180 IFE>0THENCLOSE2:OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.blacklist,s,a"
33190 PRINT#2,I$:CLOSE2:CLOSE1
33200 IFVAL(MID$(VT$(10),3))>=VT(8)THENVT$(8)="0":VT$(9)="0":VT$(10)="0":VT$(11)="0":VT(0)=VT(0)+VT(8):VT$(0)=STR$(VT(0))
34000 IFVT(12)=0THEN35000:REM*****BONDS
34010 IFVT(13)=0THEN35000
34020 W0=W0OR1:VT(13)=VT(13)-1:VT$(13)=STR$(VT(13))
34030 VT(14)=VT(14)+(VT(43)*(VT(44)/VT(45)/100))
34040 VT$(14)=STR$(VT(14))
35000 IFW0=0THEN35030
35010 IFW0AND2=2THENCLOSE2:OPEN2,U1,2,MID$(STR$(D1),2)+":bnk.accounts"
35020 RECORD#2,W1:A$="":FORI=0TO14:A$=A$+VT$(I)+R$:NEXTI:PRINT#2,A$
35030 W1=W1+1:GOTO31000
55555 U=PEEK(186):OPEN1,U,15,"s0:bnk.maint":CLOSE1:DSAVE"bnk.maint",U(U):STOP
