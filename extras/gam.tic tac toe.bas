!--------------------------------------------------
!- Saturday, May 20, 2017 1:36:12 AM
!- Import of : 
!- c:\src\zelch128\extras\gam.tic tac toe.prg
!- Commodore 128 BASIC 7/7.1
!--------------------------------------------------
1 PRINT:GOTO61000
2200 GETKEYAN$:IFINSTR("abcdefghijklmnopqrstuvwxyz",AN$)THENAN$=CHR$(ASC(AN$)OR128)
2210 PRINT"{white}"AN$:RETURN
61000 AN$="":CL$="{red}{pink}{yellow}{blue}{light blue}{cyan}{green}{light green}{white}":SY$="":PRINT:PRINT"{down*3}{light blue}TIC-TAC-TOE  {white}V{light blue}2{white}.{light blue}0":FORX=0TO10:SO(X)=0:NEXT
61001 PRINT"{down}{white}THE{sh space}WESTERN{sh space}WHITE{sh space}HOUSE{sh space}714-498-2841{down}"
61002 GOSUB61024
61010 PRINT"{down*2}{light blue}Where do you move? {white}";:GOSUB2200
61012 I%=VAL(AN$):IFI%>9THENGOTO61010
61014 IFI%<1THENGOTO61010
61016 IFSO(I%)=0THENGOTO61020
61018 PRINT"{down}{yellow}That square is taken...":GOTO61010
61020 L%=1:SO(I%)=1
61022 GOSUB61024:GOTO61072
61024 PRINT:FORX=1TO9:PRINT" ";:IFSO(X)<>-1THEN61028
61026 PRINT"{white}O ";:GOTO61034
61028 IFSO(X)THEN61032
61030 PRINTMID$(CL$,X,1);" ";MID$(STR$(X),2);:GOTO61034
61032 PRINT"{blue}X ";
61034 IFX<>3ANDX<>6THEN61038
61036 PRINT:PRINT"{green}{sh asterisk*3}{light green}{sh +}{green}{sh asterisk*3}{light green}{sh +}{green}{sh asterisk*3}":GOTO61042
61038 IFX=9THEN61042
61040 PRINT"{light green}{sh -}";
61042 NEXTX:PRINT:IFAN$=""THENRETURN:PRINT"{down*2}":ELSEFORT=1TO7STEP3
61044 IFSO(T)<>SO(T+1)THEN61052
61046 IFSO(T)<>SO(T+2)THEN61052
61048 IFSO(T)=-1THEN61118
61050 IFSO(T)=1THEN61116
61052 NEXTT:FORT=1TO3:IFSO(T)<>SO(T+3)THEN61060
61054 IFSO(T)<>SO(T+6)THEN61060
61056 IFSO(T)=-1THEN61118
61058 IFSO(T)=1THEN61116
61060 NEXTT:FORT=1TO9:IFSO(T)=0THEN61064
61062 NEXTT:GOTO61120
61064 IFSO(5)<>L%THEN61070
61066 IFSO(1)=L%ANDSO(9)=L%THEN61114
61068 IFSO(3)=L%ANDSO(7)=L%THEN61114
61070 RETURN
37008 STOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPSTOPDIRECTORYI%=0:L%=-1:N%=-1:IFSO(5)=0THENI%=5:SO(I%)=-1:GOTO61108
61074 I%=I%+1
61076 IFSO(I%)=N%ANDSO(I%+3)=N%ANDSO(I%+6)=0THENSO(I%+6)=-1:GOTO61110
61078 IFSO(I%)=N%ANDSO(I%+6)=N%ANDSO(I%+3)=0THENSO(I%+3)=-1:GOTO61110
61080 IFSO(I%+3)=N%ANDSO(I%+6)=N%ANDSO(I%)=0THENSO(I%)=-1:GOTO61110
61082 IFI%<3THENGOTO61074
61084 I%=1
61086 IFSO(I%)=N%ANDSO(I%+1)=N%ANDSO(I%+2)=0THENSO(I%+2)=-1:GOTO61110
61088 IFSO(I%)=0ANDSO(I%+1)=N%ANDSO(I%+2)=N%THENSO(I%)=-1:GOTO61110
61090 IFSO(I%)=N%ANDSO(I%+2)=N%ANDSO(I%+1)=0THENSO(I%+1)=-1:GOTO61110
61092 IFI%<7THENI%=I%+3:GOTO61086
61094 I%=1
61096 IFSO(I%)=N%ANDSO(I%+4)=N%ANDSO(I%+8)=0THENSO(I%+8)=-1:GOTO61110
61098 IFSO(I%+8)=N%ANDSO(I%+4)=N%ANDSO(I%)=0THENSO(I%)=-1:GOTO61110
61100 IFSO(I%+6)=N%ANDSO(I%+4)=N%ANDSO(I%+2)=0THENSO(I%+2)=-1:GOTO61110
61102 IFSO(I%+2)=N%ANDSO(I%+4)=N%ANDSO(I%+6)=0THENSO(I%+6)=-1:GOTO61110
61104 N%=N%+2:IFN%=1THENI%=0:GOTO61074
61106 I%=INT(RND(1)*9)+1:IFSO(I%)<>0THENGOTO61104
61108 SO(I%)=-1
61110 PRINT"{down*2}The computer moves to...":GOSUB61024
61112 GOTO61010
61114 IFL%=-1THEN61118
61116 PRINT"{down*2}YOU WIN!!!{ct g*3} LUCKY!!":GOTO61122
61118 PRINT"{down*2}I WIN!!!{ct g*3} HAHAHAHAHAHAHA!!!{ct g*3}":GOTO61122
61120 PRINT"{down*2}C{ct g}A{ct g}T{ct g} - TIE GAME..."
61122 PRINT"{down*2}PLAY AGAIN (Y/N)?";
61124 GOSUB2200:IFAN$="Y"THENL%=0:FORX=1TO9:SO(X)=0:NEXTX:I%=0:N%=0:GOTO61000
61126 PRINT"{down*2}Thanks For Playing!
61128 L%=0:FORX=1TO9:S
